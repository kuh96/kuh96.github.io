title: 間違い報告： 既約と可約（Joh著）などなど
date: 2015-07-25 12:00
tags:
---

# 間違い報告：既約と可約（Joh著）などなど

Johさんは一杯書いてくれていてうれしいのですが、
ときどきへんな・間違った思い込みで突っ走ってしまうときがあるようです :-)

ざっと見ただけで、また全然詳しくはないのですが、
明らかな間違いがいくつかあるので報告しておきます。

(7/26）参考情報として、「多項式の因数分解と微分」を最後に追加

## 既約と可約（Joh著）

http://hooktail.sub.jp/algebra/Reducible/ の最後

#### 定理
> （標数 0 の係数体上の）既約な代数方程式は、重解を持ちません。　

### 証明（完全にまちがい！）　※1

> 体 $F$ 上既約な多項式 $f(x)=c\_{0}+c\_{1}x+...+c\_{n}x^{n}$ を考えます。
> もしも $f(x)$ が $m$ 重解 $\alpha$ を持つとすると、 
> $f(x)=c(x-\alpha )^{m}(x-{\alpha}\_{1})\cdot \cdot \cdot (x-{\alpha}\_{n-m})$ と書けるはずです。
> これは、 $f(x)$ が $(x-\alpha )$ で可約だということを意味しますから、既約な多項式だという仮定に反します。

#### 間違い箇所 ※2

$f(x)$ は $F$ 上既約なので、上の $\alpha$ はもちろん $F$ の元ではなく、
$f(x)$ が $(x-\alpha )$ で可約だということを **意味しません**。

たとえば 有理数体上の多項式 $f(x)$ が拡大体上で
$f(x)=(x - \sqrt{2})^{2}g(x)$ と分解できたとしても、
$(x - \sqrt{2})^2 = (x^2- 2\sqrt{2}x + 2)$ は有理数体上の多項式ではありません。

実は $g(x)$ のほうが必ず $(x + \sqrt{2})^2$ を因子にもつため、
これと合わさって $f(x) = (x^2 - 2)^{2}h(x)$ となり、有理数体上で可約になるのです。

以降、これと類似した間違いがいくつかあります。訂正は ※3 に後述。

## 代数的拡大体と最小多項式（Joh著）

http://hooktail.sub.jp/algebra/AlgebraicExtension/#id4

### 注および説明（へん！）

**注**
> 例えば 2 は x−2=0 の解ですが， (x−4)(x−3)(x−2)=0 の解でもあります．本質的に， 2 は (x−2) の部分だけから出てくるわけですが，このように関係ない因数を加えて次数を上げていけば， 2 を解とする代数方程式自体は無限にあることが分かります．

**説明**
> 最小多項式には次の重要な性質があります．
> 
> 最小多項式は F 上既約です．
> 最小多項式は α を解とする， F 上の全ての多項式を割ることが出来ます．
> これらの性質は，上の注に補足したイメージを持っていれば明らかでしょう．

#### へんな箇所

上の注の例は無意味で、そのイメージでは全然明らかでないです。

ポイントは　F 上の多項式が F 上にない α を根に持つなら、
必ず F 上にない他の根(α に**共役な根**）も持たなければいけない、ということです。

 - 共役な根は１つ以上のときもあります
 - 根と係数の関係、を満たすためには F 上にない他の根が必要ということ
 - Joh さん自身が書いているではないですか
   http://hooktail.sub.jp/algebra/NormalExtension/

証明は簡単です。

- α は代数的数、よってそれを根とする F 上の多項式が存在
- そのうち次数が最小のものの１つを h(x) とする(定数倍を除いて１つに決まる). 当然 h(a) = 0
- F 上で h(x)=g(x)k(x) なら g(α)=0 or k(α)=0  ‥(A) 
- α を根とする F 上の多項式を h(x) で割った余りを r(x) とすれば r(α)=0 ‥(B) 

h(x) は最小次数だったので、h(x) は (A)より F 上既約で、(B)より α を根とする F上のすべての多項式を割り切ることがわかります。

### 段落最後の例 （まちがい!）

>  $Q(\omega)$ ($\omega$ は 1 の三乗根)の元が $a+\omega b+\omega^{2} c$ の形に書ける

#### 訂正
$\omega$ は $\omega^{2} + \omega + 1=0$ の根なので、$\omega^{2}=-(\omega+1)$です。
すなわち $Q(\omega)$ は2次の拡大で、その元は $a'+\omega b'$ と書けます。

なお $\alpha=\sqrt[3]{2}$ なら最小多項式は $(x^3 - 2)$ で、
$Q(\sqrt[3]{2})$ は3次の拡大で、$a + b \sqrt[3]{2} + c \sqrt[3]{2}^2$ と書けます。
しかし $(x^3 - 2)$ の他の2根 $\sqrt[3]{2} \omega$ $\sqrt[3]{2} \omega^2$ は $Q(\sqrt[3]{2})$ にはありません。
すべての根を含むには　6次の拡大 $Q(\sqrt[3]{2}, \omega)$ が必要です。

## 標数（Joh著）

http://hooktail.sub.jp/algebra/Characteristic/#id6

### 定理

> 有限体 F の位数を |F|=q ，標数を p ， 素体を F0 とします． [F:F0]=n のとき， 
> $q=p^n$ がなりたちます．

#### その証明（不完全）

これでは 位数 $q=p^n$ の体が存在すること、が示されていません.


## 分離拡大体（Joh著）

### 標数0の場合（※１と同じ。完全にまちがい！）

http://hooktail.sub.jp/algebra/SeparableExtension/#id2

> 公約元 $(x−\alpha)$ を持ちますので，既約ではありません．

$(x−\alpha)$ は F 上の多項式ではないので、これはとんでもないまちがいです。

#### 訂正 ※3

公約元として **α の最小多項式をもつので**、既約ではありません．
 
$f(x)$ と $f'(x)$ が共通因子 $(x - \alpha)$ を持つとする。
$\alpha$ の最小多項式を $h(x)$ とすると、$h(x)$ は $f(x),f'(x)$ を割り切るが、
$f'(x)$ の次数は $f(x)$ より 1 小さいので、$h(x)$ の次数は $f(x)$ より 1 以上小さい。
したがって $f(x)$ は $h(x)$ の定数倍ではなく、従って可約である。

### 標数≠０の場合、の説明（完全にまちがい！）

http://hooktail.sub.jp/algebra/SeparableExtension/#id3

> ... この体 F 上で，方程式 $f(x)=x^p+a$ を考えて見ましょう．
> これは確かに **既約** ですが...
> 
> $x^n+a^n=(x+a)^n$ 
> 左辺は **既約** ですが...

#### 間違い理由

とんでもないです。上の２つとも既約であるとは限りません。

例えば 標数 3 の素体 $F\_{3} = \\{0,1,2\\}$ 上では、以下のように因数分解できます。

$$
x^3 + 1 = x^3 + 1^3 = (x + 1)^3  \\\\
x^3 + 2 = x^3 + 2^3 = (x + 2)^3 \\\\
$$

標数 p が素数の素体では、任意の元 $a$ に対して $a^p=a$ （フェルマーの小定理!）、すなわち自分自身が自分の p 乗根です。

さらに、標数 p の有限体 K では、$\forall \beta \in K$ に対して、$\beta$ の p 乗根 $\beta^{1/p}$ がただ１つ存在し、
有限体 K の任意の代数的拡大は分離拡大である、とのことです。

 - 松坂和夫　代数系入門 p.272 問題 4, 5

従って、既約だが重根をもつ例をつくるには、
標数 p ≠ 0 の無限体、例えば有限体上の有理関数、などを考える必要があります。

とりあえず以上です。疲れた～

-----
### 参考： 多項式の因数分解と微分 (7/26 追記）

重根の有無の判定に微分を使いますが、誰が考えたのか賢い方法ですね。
y = f(x) のグラフを描くと、重根のときには x 軸に接する、すなわち f(x) = 0, f'(x) = 0 となる x が重根になるわけです。

これに関連して、(おおきな)多項式を因数分解するときには、**まず微分して重根を持つかを調べる**
というのが鉄則みたいです。

すなわち f(x) をまず $f(x) = a_1(x) a_2(x)^2 a_3(x)^3 .. a_k(x)^k$ の形に因数分解します。
[square-free factorization](https://en.wikipedia.org/wiki/Square-free_polynomial)

これは高速かつ簡単にできます。

- f(x) の微分 f'(x) を求める ～　多項式の微分は簡単！
- f(x) と f'(x) の最大公約因子 m(x) を求める
 - これはユークリッドの互除法により高速にできます
- 最大公約因子 m(x) が 0 次でなければ、それで f(x) を割っていけば、
  $f(x) = m(x)^k g(x)$ の k (≧ 2）と g(x) が求まります.
  すなわち因数分解が一段階できたことになります。
  多項式の割り算は手動では面倒ですが、プログラムを作れば簡単
- 次に g(x) に対して同じことを繰り返せば、上の square-free factorization の形になります
- そのあと、 $a_1(x), a_2(x) ...$ それぞれの因数分解を試みます
  - この因数分解の決定的な方法は知られていません.
    しかしラッキーなら　$a_1(x), a_2(x) ...$ それぞれの次数は元の f(x) より大幅に小さいくなっているはずです

因数分解には通常、なんらかの **試行錯誤** が必要ですが、
square-free factorization までは、多項式の微分、割り算、ユークリッドの互除法という決定的かつ効率のよい方法でできてしまう、ということです。

以上、参考情報でした。




